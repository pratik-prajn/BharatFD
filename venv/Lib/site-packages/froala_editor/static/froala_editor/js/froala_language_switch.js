(function($) {
  $(document).ready(function() {
    // Create the language selector HTML.
    var langSelectorHtml = '' +
      '<div id="froala-lang-container" style="margin-bottom: 15px;">' +
        '<label for="froala-lang-selector" style="font-weight: bold;">Editor Language: </label>' +
        '<select id="froala-lang-selector">' +
          '<option value="en">English</option>' +
          '<option value="es">Spanish</option>' +
          '<option value="fr">French</option>' +
          '<option value="zh-cn">Chinese (Simplified)</option>' +
        '</select>' +
      '</div>';

    // Prepend the language selector to the admin change form.
    // .change-form is the standard class for the Django admin change form.
    $('.change-form').prepend(langSelectorHtml);

    // When the language selector value changes...
    $('#froala-lang-selector').on('change', function() {
      var newLang = $(this).val();

      // For each textarea that is a Froala editor
      $('textarea.froala-editor').each(function() {
        var $this = $(this);
        // If the Froala editor instance exists, destroy it.
        if ($this.data('froala.editor')) {
          $this.froalaEditor('destroy');
        }
        // Reinitialize the Froala editor with the new language.
        $this.froalaEditor({
          language: newLang
        });
      });
    });
  });
})(django.jQuery);
